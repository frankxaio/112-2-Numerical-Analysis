# Midterm Report Problem 10

```
B1027234 林永濬
B1027236 蕭銘宏
```

## Problem 10

$$
\begin{bmatrix}
13.422 & 0 & 0 & 0\\
-13.422 & 12.252 & 0 & 0\\
0 & -12.252 & 12.377 & 0\\
0 & 0 & -12.377 & 11.797
\end{bmatrix}
\times
\begin{bmatrix}
c_1\\
c_2\\
c_3\\
c_4
\end{bmatrix}
=
\begin{bmatrix}
750.5\\
300\\
102\\
30
\end{bmatrix}
$$

視為 $Ax=b$ 

$x$: The resulting chloride concentrations in each of the four lakes.

$b$: Loadings of chloride to each of the four lakes.

## a) Use the matrix inverse to solve for the concentrations in each of the four lakes.

### Math

$$
Ac=b \\ 
A^{-1}Ac=A^{-1}b\\
c=A^{-1}b
$$
### MATLAB

使用 `inv(A)` 計算出 $A^{-1},\ c$

```matlab
A_inv = 
   0.0745    0.0000    0.0000    0.0000 
   0.0816    0.0816    0.0000    0.0000 
   0.0808    0.0808    0.0808    0.0000 
   0.0848    0.0848    0.0848    0.0848 
c = 
    55.916  
    85.741  
    93.116  
    100.237 
```

## b) HOW much must the loading to Lake Powell be reduced for the Chloride concentration of Lake Havasu to be 75?

由題目得知
$$
c_{4}=100.237 \Rightarrow 75
$$
計算出變化量
$$
\Delta c = c_{new}-c=
\begin{bmatrix}
0\\
0\\
0\\ 
-25.237
\end{bmatrix}
$$

$$
\Delta b=b_{new}-b = 
\begin{bmatrix}
-x\\
0\\
0\\ 
0
\end{bmatrix}
$$

解 $Ax = b$


$$
Ax=b \\
A\Delta c = \Delta b \\
\begin{bmatrix}
13.422 & 0 & 0 & 0\\
-13.422 & 12.252 & 0 & 0\\
0 & -12.252 & 12.377 & 0\\
0 & 0 & -12.377 & 11.797
\end{bmatrix}
\times
\begin{bmatrix}
0\\
0\\
0\\ 
-25.237
\end{bmatrix}
= \begin{bmatrix}
-x\\
0\\
0\\ 
0
\end{bmatrix}\\
$$

$$
11.797\times -25.237 = -x\\
x = 297.72
$$

### MATLAB

使用 `eqn = A * deltac_c == delta_b` 直接計算出 $x=297.72$

## c) Using the column-sum norm, compute the condition number and how many suspect digits would be generated by solving this system.

> [!NOTE]
>
> **Column Sum Norm**
> $$
> ||A||_1 = \max_{1 \leq j \leq n} \sum_{i=1}^n |a_{ij}|
> $$
> 
>
> 1. 將每一 row 的值除所有 column 的最大值得到 norm matrix 
> 2. column sum norm = norm matrix 將 column 值取絕對值並加總，並選出最大值
>
> **Condition Number**
> $$
> \text{Cond}[A] = ||A|| \cdot ||A^{-1}||
> $$
> **Suspect Digits**
> $$
> Digits = log_{10}(\text{cond[A]})
> $$

藉由 MATLAB 計算得出

```
A_norm= 26.844
A_inv_norm= 0.322
condition_num = 8.635
suspect_digits = 0.936
```
